# Проектная работа "Веб-ларек" 

Автор: b0shan

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```



## Архитектура проекта
построена на паттерне MVP (Model-View-Presenter), который разделяет ответственность между тремя основными частями приложения:

Model (Модель): отвечает за управление данными. Она получает, сохраняет и обрабатывает информацию, например, данные о товарах или заказах, поступающие с сервера. 
Также обрабатывает данные форм и отправляет их обратно на сервер.
View (Представление): отображает интерфейс и взаимодействует с пользователем, показывая информацию, полученную из Model.Cтраница с товарами, модальное окно корзины или форма заказа.
Presenter (Представитель): является посредником между Model и View. Он получает события от View (например, нажатие кнопок) и, используя Model, обновляет данные, а затем отображает изменения во View.

View реагирует на действия пользователя и передает события в Presenter.
Presenter получает эти события и запрашивает или обновляет данные через Model.
После обновления данных Presenter обновляет View, чтобы пользователь видел актуальные данные.

## Приложение состоит из следующих основных классов:

# Класс Api:
Назначение: Класс для работы с API, выполняет отправку и получение данных с сервера.
В конструктор передаются базовый URL сервера и опциональный объект с заголовком запроса.
  Методы:
  ```
  get: выполняет GET-запрос на указанный в параметрах эндпоинт и возвращает промис с объектом, полученным в ответе от сервера.
  post: принимает объект с данными, которые будут отправлены в теле запроса в формате JSON, и отправляет их на эндпоинт,
  переданный как параметр при вызове метода.
  ```

# Класс EventEmitter: 
Назначение: Управляет подписками на события, устанавливает, снимает и вызывает обработчики событий.
  Методы:
  ```
  on(eventName: EventName, callback: (event: T) => void) – Подписка на событие.
  off(eventName: EventName, callback: Subscriber): void – Отмена подписки на событие.
  emit(eventName: string, data?: T): void – Вызов события с данными.
  ```

# Класс Model: Абстрактный класс, предназначен для работы с данными и внесения изменений.
Его конструктор создает новый экземпляр модели с указанными данными и событиями, которые реализует IEvents.
  
  Методы:
   ```
   sendUpdates(event: string, payload?: object)  – Отправка события с обновленными данными.
   ```

# Класс AppData (наследник Model): 
Назначение: Хранит данные приложения, включая каталог товаров, элементы корзины, данные заказа и ошибки формы.

  Поля
  ```
  catalog – Массив объектов каталога товаров.
  basket  – Массив идентификаторов товаров в корзине.
  preview  – Идентификатор открытого товара.
  formErrors  – Массив ошибок формы.
  order - Заказ
  ```

  Методы:
  ```
  getCatalog- получение массива каталога товаров.
  getIndex  – Возвращает данные товара по его ID.
  toggleBasket – Добавляет или удаляет статус товара из корзины.
  getBasketTotal – Возвращает общую сумму корзины.
  clearBasket - очищает корзину.  
  validateOrder – проводит проверку валидности заказа и отправляет событие об изменении.
  resetOrder – сбрасывает данные о заказе.
  setPreview - Предпросмотр
  setOrderPayment - способа оплаты заказа
  setOrderAddress - адресс заказа
  getButtonStatus - содержимое кнопки согласно статусу
  setOrderPhone - телефон в заказе
  setOrderEmail - почта в заказе
  ```

# Класс Component: абстрактный класс для всех компонентов пользовательского интерфейса.
  Назначение: Базовый класс для создания UI-компонентов с методами для работы с DOM.
  Конструктор принимает HTMLElement
  Методы:
  ```
  setText - Устанавливает текст элемента.
  hideElement – Скрывает элемент.
  showElement – Показывает элемент.
  setImage – Устанавливает изображение и альтернативный текст.
  renderComponent - Создаёт и возвращает компонент.
  ```

# Класс Modal: 
  Назначение: Управляет модальными окнами.
  Методы:
  ```
  open – Открывает модальное окно.
  close – Закрывает модальное окно.
  render – Отображает модальное окно.
  ```

# Класс Page 
  Является компонентом страницы и управляет элементами страницы. 
  Добавляет слушатель при нажатии на корзину. 
  Поля HTML-элементов: 
  -обертка страницы. 
  -отображение каталога с карточками.
  -отображения корзины.
  -кол-во товаров в корзине.

  Свойства:
  ```
  counter - устанавливка значение счетчика
  gallery - обновление содержимого каталога новыми элементами.
  ```
  Методы:
  ```
  counter - устанавливает значение счетчика
  gallery - заменяет содержимое каталога новыми элементами.
  locked - управляет видимостью и доступностью элементов страницы, позволяя или запрещая пользовательские действия.
  ```
  
  
# Класс Basket: 
  Назначение: Компонент для отображения и управления корзиной товаров.
  Конструктор принимает HTMLElement и объект IEvents
  Методы:
  ```
  items — обновляет содержимое списка товаров в корзине.
  sum – обновляет отображаемую сумму корзины.
  ```

# Класс Card: 
  Назначение: Компонент для отображения карточки товара.
  
  Методы:
  ```
  set id  — Устанавливает уникальный идентификатор карточки.
  get id - Возвращает идентификатор карточки.
  set title  — Устанавливает заголовок карточки.
  get title — Возвращает текущий заголовок карточки.
  set description- Устанавливает описание карточки.
  get description — Возвращает текущее описание карточки.
  set price - Устанавливает цену карточки.
  get price — Возвращает текущую цену карточки в виде строки.
  set image — Устанавливает URL изображения для карточки.
  set category- Устанавливает категорию карточки
  get category — Возвращает текущую категорию карточки.
  set button — Устанавливает текст на кнопке карточки. Этот метод используется, чтобы обновить текст кнопки, например, от "В корзину" на "Убрать из корзины" в зависимости от состояния товара.
  ```



# Класс Form:  
  Назначение: Класс для управления формой заказа, включая валидацию и отображение ошибок.

  Поля:
  valid- устанавливает состояние кнопки в зависимости от валидности полей формы
  errors - устанавливает текст об ошибке в области для вывода ошибок.

  Методы:
  ```
  resetFields – Очищает поля формы.
  inputChange – Обрабатывает изменения в полях ввода.
  renderForm – Отображает форму на странице.
  ```


# Класс OrderPayment и OrderContacts (наследник Form)
  Конструктор принимает HTMLElement и объект IEvents
  Инициализирует кнопки для выбора способа оплаты, которые будут использованы в методах, а также поле для ввода адреса. 
  При активации кнопок оплаты устанавливается обработчик событий, который передает выбранные данные.   
  Свойства:
  ```
  address: HTMLInputElement - поле для ввода адреса.
  buttonCash: HTMLButtonElement -  Кнопка для выбора наличного расчета.
  buttonOnline: HTMLButtonElement -  Кнопка для выбора онлайн-оплаты.
  ```
  Методы:
  ```
  setPayMethod – для выбора способа оплаты.
  address – для указания адреса доставки.

  phone – для указания номера телефона для заказа.
  email – для указания электронной почты для заказа.
  ```

# Класс Success (наследник Component)
  Назначение: Компонент для отображения экрана успешного оформления заказа.
  Методы:
  ```
  total - устанавливает сумму заказа
  ```

 

## Основные типы данных, используемые в приложении :
```
// Слой данных
// Интерфейс для работы с данными, полученными с сервера
export interface ILarekAPI {
	getProductItem: (id: string) => Promise<ICard>;
	getProductList: () => Promise<ICard[]>;
	orderItems(order: IOrder): Promise<IOrderResults>;
}

// Работа с карточками
// Карточка
export interface ICard {
	id: string;
	title: string;
	price: number | null;
	description: string;
	image: string;
	category: CardCategory;
	button: string;
}

export interface ICardActions {
	onClick: (event: MouseEvent) => void;
}

export interface ICardList {
	total: number;
	items: ICard[];
}

// Категория для карточки
export type CardCategory =
	| 'софт-скилл'
	| 'другое'
	| 'дополнительное'
	| 'хард-скилл'
	| 'кнопка';

// Тип карточки для главной страницы
export type TCardPage = Pick<
	ICard,
	'id' | 'title' | 'price' | 'image' | 'category'
>;

// Тип карточки для корзины
export type TCardBasket = Pick<ICard, 'id' | 'title' | 'price'>;

// Корзина
export interface IBasket {
	items: TCardBasket[];
	sum: number | null;
}

// Заказ
export interface IOrder {
	total: number;
	items: string[];
	email: string;
	phone: string;
	address: string;
	payment: string;
}

// Тип оплаты заказа
export type PaymentMethod = 'онлайн' | '' | 'при получении';

// Тип для заказа с формой способа оплаты и адреса
export type TOrderPayment = Pick<IOrder, 'payment' | 'address'>;

// Тип для заказа с формой почты и телефона
export type TOrderContacts = Pick<IOrder, 'email' | 'phone'>;

export type TOrderField = TOrderContacts & TOrderPayment;
// Интерфейс выполнения успешной операции
export interface IOrderResults {
	id: string;
	total: number;
}

// Тип ошибок форм заказа
export type FormErrors = Partial<Record<keyof IOrder, string>>;

// Слой представления
// Интерфейс компонента страницы
export interface IPage {
	counter: number;
	catalog: HTMLElement[];
	locked: boolean;
}

// Интерфейс компонента форм
export interface IForm {
	valid: boolean;
	errors: string[];
}

// Интерфейс компонента модального окна
export interface IModalData {
	content: HTMLElement;
}

// Интерфейс компонента успешного оформления заказа
export interface ISuccess {
	total: number;
}
export interface ISuccessActions {
	onClick: () => void;
}
```